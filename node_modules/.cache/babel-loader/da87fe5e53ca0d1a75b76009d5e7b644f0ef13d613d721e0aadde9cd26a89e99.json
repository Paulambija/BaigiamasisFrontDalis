{"ast":null,"code":"import React,{useEffect,useRef,useState}from\"react\";import\"./ProductsList.css\";import{useGeolocation}from\"react-use\";import axios from\"axios\";import{Link,useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function ProductsList(){const geo=useGeolocation();const navigate=useNavigate();const ref=useRef();const[todos,setTodos]=useState(()=>createInitialTodos());const[products,setProducts]=useState([]);const[inputValue,setInputValue]=useState();const[loading,setLoading]=useState(true);const[error,setError]=useState('');const isLoggedIn=!!localStorage.getItem(\"accessToken\");let isAdmin=false;if(localStorage.getItem(\"user\")){var _user$roles;const user=JSON.parse(localStorage.getItem(\"user\"));isAdmin=(_user$roles=user.roles)===null||_user$roles===void 0?void 0:_user$roles.some(role=>role.name===\"ADMIN\");}useEffect(()=>{getData();},[]);const getData=async()=>{try{setLoading(true);let response=await axios.get(\"http://localhost:8080/products\");setProducts(response.data);setError('');}catch(error){console.log(\"Product fetch error\",error);setError(error.response.data.message);}finally{setLoading(false);}};function createInitialTodos(){console.log(\"kuriami initial todos\");return[\"Pirmą užduotis yra labai ilga ir labai ilgai trunkanti\",\"Antra užduotis\",\"Trečia užduotis\",\"Sutvarkyti kambarį\"];}const handleSubmit=()=>{// nunaviguotu i naujo produkto komponenta\nnavigate(\"/home/products-new\");// setTodos([...todos, inputValue]);\n// setInputValue(\"\");\n};const handleDelete=async uuid=>{setLoading(true);try{await axios.delete(\"http://localhost:8080/products/\".concat(uuid),{headers:{Authorization:\"Bearer \".concat(localStorage.getItem('accessToken'))}});getData();}catch(error){console.log(\"Product fetch error\",error);setLoading(false);setError(error.response.data.message);}};return/*#__PURE__*/_jsxs(\"div\",{style:{minWidth:\"1024px\"},children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center my-4\",children:\"Produkt\\u0173 lentel\\u0117\"}),loading&&/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border text-primary\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"Loading...\"})})}),!loading&&error&&/*#__PURE__*/_jsx(\"p\",{className:\"alert alert-danger mt-2\",children:error}),!loading&&/*#__PURE__*/_jsxs(\"table\",{className:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Nr.\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Pavadinimas\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Kaina\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Kiekis\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Veiksmai\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:products===null||products===void 0?void 0:products.map((product,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:isLoggedIn?/*#__PURE__*/_jsx(Link,{to:\"/home/product-details/\".concat(product.id),children:product.name}):/*#__PURE__*/_jsxs(_Fragment,{children:[\" \",product.name,\" \"]})}),/*#__PURE__*/_jsx(\"td\",{children:product.price}),/*#__PURE__*/_jsx(\"td\",{children:product.quantity}),/*#__PURE__*/_jsx(\"td\",{children:isAdmin&&/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:()=>handleDelete(product.id),children:\"Trinti\"})})]},index))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-container\",children:isAdmin&&/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmit,type:\"button\",className:\"btn btn-primary align-self-center\",children:\"Prid\\u0117ti nauj\\u0105 u\\u017Eduot\\u012F\"})})]});}","map":{"version":3,"names":["React","useEffect","useRef","useState","useGeolocation","axios","Link","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ProductsList","geo","navigate","ref","todos","setTodos","createInitialTodos","products","setProducts","inputValue","setInputValue","loading","setLoading","error","setError","isLoggedIn","localStorage","getItem","isAdmin","_user$roles","user","JSON","parse","roles","some","role","name","getData","response","get","data","console","log","message","handleSubmit","handleDelete","uuid","delete","concat","headers","Authorization","style","minWidth","children","className","scope","map","product","index","to","id","price","quantity","onClick","type"],"sources":["E:/Java mokymai/KARTOJIMAS/BAIGIAMASIS/FrontDalisReact-main/src/ProductsList.js"],"sourcesContent":["import React, {useEffect, useRef, useState} from \"react\";\nimport \"./ProductsList.css\";\nimport {useGeolocation} from \"react-use\";\nimport axios from \"axios\";\nimport {Link, useNavigate} from \"react-router-dom\";\n\nexport default function ProductsList() {\n\n    const geo = useGeolocation();\n    const navigate = useNavigate();\n    const ref = useRef();\n\n    const [todos, setTodos] = useState(() => createInitialTodos());\n    const [products, setProducts] = useState([]);\n    const [inputValue, setInputValue] = useState();\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState('');\n\n    const isLoggedIn = !!localStorage.getItem(\"accessToken\")\n    let isAdmin = false;\n    if(localStorage.getItem(\"user\")){\n        const user = JSON.parse(localStorage.getItem(\"user\"));\n        isAdmin = user.roles?.some(role => role.name === \"ADMIN\");\n    }\n\n    useEffect(() => {\n        getData();\n    }, []);\n\n    const getData = async () => {\n        try {\n            setLoading(true);\n            let response = await axios.get(\"http://localhost:8080/products\");\n            setProducts(response.data);\n            setError('')\n        } catch (error){\n            console.log(\"Product fetch error\", error)\n            setError(error.response.data.message)\n        } finally {\n            setLoading(false);\n        }\n    }\n\n    function createInitialTodos() {\n        console.log(\"kuriami initial todos\");\n        return [\n            \"Pirmą užduotis yra labai ilga ir labai ilgai trunkanti\",\n            \"Antra užduotis\",\n            \"Trečia užduotis\",\n            \"Sutvarkyti kambarį\"\n        ]\n    }\n\n    const handleSubmit = () => {\n        // nunaviguotu i naujo produkto komponenta\n        navigate(\"/home/products-new\");\n        // setTodos([...todos, inputValue]);\n        // setInputValue(\"\");\n    }\n\n    const handleDelete = async (uuid) => {\n        setLoading(true);\n        try {\n            await axios.delete(`http://localhost:8080/products/${uuid}`, {\n                headers: {\n                    Authorization: `Bearer ${localStorage.getItem('accessToken')}`\n                }\n            })\n            getData();\n        } catch (error){\n            console.log(\"Product fetch error\", error)\n            setLoading(false)\n            setError(error.response.data.message)\n        }\n    }\n\n    return (\n        <div style={{minWidth: \"1024px\"}}>\n            <h2 className={\"text-center my-4\"}>Produktų lentelė</h2>\n\n            {/*{(!products || products.length < 1) && <div style={{fontWeight: 700, color: \"rebeccapurple\"}}>*/}\n            {/*    Šiuo metu produktų nėra, prašome įterpti*/}\n            {/*</div>}*/}\n\n            {/*{products && products.map((product, index) => (*/}\n            {/*    <div key={index}>*/}\n            {/*        Produkto pavadinimas: <b>{product.name}</b> ({product.price} EUR), kiekis: <b>{product.quantity}</b>*/}\n            {/*        /!*<button onClick={() => handleDelete(product)}>Ištrinti</button>*!/*/}\n            {/*    </div>*/}\n            {/*))}*/}\n\n            {loading && <div className={\"d-flex justify-content-center\"}>\n                <div className=\"spinner-border text-primary\" role=\"status\">\n                    <span className=\"visually-hidden\">Loading...</span>\n                </div>\n            </div>}\n\n            { (!loading && error) &&\n                <p className=\"alert alert-danger mt-2\">{ error }</p>\n            }\n\n            {!loading && <table className=\"table\">\n                <thead>\n                <tr>\n                    <th scope=\"col\">Nr.</th>\n                    <th scope=\"col\">Pavadinimas</th>\n                    <th scope=\"col\">Kaina</th>\n                    <th scope=\"col\">Kiekis</th>\n                    <th scope=\"col\">Veiksmai</th>\n                </tr>\n                </thead>\n                <tbody>\n                {products?.map((product, index) => <tr key={index}>\n                    <td>{index + 1}</td>\n                    <td>\n                        {isLoggedIn ? <Link to={`/home/product-details/${product.id}`}>{product.name}</Link> : <> {product.name} </> }\n                    </td>\n                    <td>{product.price}</td>\n                    <td>{product.quantity}</td>\n                    <td>\n                        {isAdmin && <button className=\"btn btn-danger\" onClick={() => handleDelete(product.id)}>Trinti</button>}\n                    </td>\n                </tr>)}\n                </tbody>\n            </table>}\n\n            <div className={\"form-container\"}>\n                {/*<input value={inputValue}*/}\n                {/*       onChange={(e) => setInputValue(e.target.value)}*/}\n                {/*       className={\"todo-input-field\"}*/}\n                {/*       type={\"text\"}*/}\n                {/*       placeholder={\"Įveskite kitą užduotį (kontroliuojamas \"}/>*/}\n\n                {/*<form>*/}\n                {/*    <input className={\"todo-input-field\"}*/}\n                {/*           ref={ref}*/}\n                {/*           required={true}*/}\n                {/*           placeholder={\"Įveskite kitą užduotį (nekontroliuojama) \"}/>*/}\n\n                {/*    <button type={\"submit\"}/>*/}\n                {/*</form>*/}\n\n                {/*         buvo anksciau: () => setTodos([...todos, inputValue])              */}\n                {isAdmin &&\n                    <button\n                        onClick={handleSubmit}\n                        type=\"button\"\n                        className=\"btn btn-primary align-self-center\">\n                        Pridėti naują užduotį\n                    </button>\n                }\n                {/*<button onClick={handleSubmit}>Pridėti naują užduotį</button>*/}\n            </div>\n\n            {/*<pre>*/}\n            {/*     {JSON.stringify(geo, null, 2)}*/}\n            {/* </pre>*/}\n        </div>\n    )\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}